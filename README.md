# WebAuth
基于tomcat，结合编程式安全和申明式安全进行web用户验证和授权的示例

    首先，说明一下编写这个示例的目的。当初在我学习Java的时候，就已经接触了Tomcat，但由于教学目的，老师留给我们深入了解Tomcat容器的时间并不多。那时我们会写一些功能十分简单的网站作为课后作业，但是在每次做网站用户验证和授权时非常痛苦。用户验证和授权是非常重要也非常基础的功能，但是一个广泛通用、灵活可扩展、尽可能复用已有代码的实现方法对当时的我还是要求太高。毫无疑问，我最初的代码完全是使用编程式安全，每次doGet、doPost方法一开始就要自己检查用户验证和授权，非常枯燥乏味，而且硬编码缺乏灵活性。偶尔间竟然看到request对象竟然有login()方法，当时瞬间就觉得自己很蠢，但是奈何不知道这个方法该如何使用。随着对Servlet逐步了解，我知道了申明式安全。虽然申明式安全把程序员从枯燥的检查工作中解放出来，也足够灵活，但是在某些方面限制很大。比如Form验证方式完全隐藏登录页面地址，只在你访问某些需要验证身份的网页时会自动转发，而且没有验证码之类的技术（尽管Tomcat可以配置登录限制之类的组件），完全不符合绝大多数网站的实现方式。而Basic和Digest验证非常简陋，不实用，除了8年前的无线路由器和Tomcat自带Examples的web网站使用这种方式外，我没有见过其它使用这种技术的网站。在此种情况下，我决定使用编程式安全和申明式安全结合的方式实现用户验证和授权。因为使用了申明式安全，Tomcat容器的很多自带组件都可以配置使用，如单点登录SSO、JDBC连接池、登陆限制等。此示例还实现了一个简单的基于申明式安全的防CSRF攻击的Filter。
    接下来简单介绍一下实现细节。
